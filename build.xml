<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
         DefaultTargets="Run"
         ToolsVersion="4.0">
  <ImportGroup>
    <Import Project="$(MSBuildProjectDirectory)\version.xml" />
  </ImportGroup>
  <ImportGroup>
    <Import Project="$(MSBuildExtensionsPath)\Cavity\Version.xml" />
    <Import Project="$(MSBuildExtensionsPath)\Cavity\Clean.all" />
    <Import Project="$(MSBuildExtensionsPath)\Cavity\Facts.test" />
    <Import Project="$(MSBuildExtensionsPath)\Cavity\Bundle.all" />
  </ImportGroup>
  <PropertyGroup>
    <Configuration Condition="'$(Configuration)'==''">Release</Configuration>
    <MSBuildProperties>$(MSBuildProperties);CommandLineBuild=true;Configuration=$(Configuration)</MSBuildProperties>
  </PropertyGroup>
  <Target Name="Run" DependsOnTargets="Version">
    <CallTarget Targets="Clean" />
    <CallTarget Targets="Build" />
    <CallTarget Targets="Test Facts" />
    <CallTarget Targets="Bundle" />
  </Target>
  <Target Name="Build">
    <MSBuild Projects="$(MSBuildProjectDirectory)\build.AnyCPU.xml"
             Targets="Rebuild"
             Properties="$(MSBuildProperties)"
             BuildInParallel="true" />
    <MSBuild Projects="$(MSBuildProjectDirectory)\build.AnyCPU.not20.xml"
             Targets="Rebuild"
             Properties="$(MSBuildProperties)"
             BuildInParallel="true" />
    <MSBuild Projects="$(MSBuildProjectDirectory)\build.AnyCPU.net40.xml"
             Targets="Rebuild"
             Properties="$(MSBuildProperties)"
             BuildInParallel="true" />
    <MSBuild Projects="$(MSBuildProjectDirectory)\build.x86.net40.xml"
             Targets="Rebuild"
             Properties="$(MSBuildProperties)"
             BuildInParallel="true" />
    <MSBuild Projects="$(MSBuildProjectDirectory)\build.x64.net40.xml"
             Targets="Rebuild"
             Properties="$(MSBuildProperties)"
             BuildInParallel="true" />
  </Target>
</Project>