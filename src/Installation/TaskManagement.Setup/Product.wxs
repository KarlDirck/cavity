<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
	<Product Id="6442166c-81bb-4117-bcfc-036f5dff277a"
           Name="Cavity Task Management"
           Language="1033"
           Version="1.0.0.0"
           Manufacturer="Cavity"
           UpgradeCode="d3c6a801-9e05-4bd1-9c35-bc44c426d1c7">
		<Package InstallerVersion="200"
             InstallScope="perMachine"
             Compressed="yes"
             Description="Installs Cavity Task Management." />

		<Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="Common" Name="Common Files">
          <Directory Id="CommonCompany" Name="Cavity">
            <Directory Id="CommonTaskManagement" Name="Task Management">
              <Component Id="EventLog"
                         Guid="3c6164ee-6378-4681-b891-2b81c60db682">
                <File Id="Messages"
                      KeyPath="yes"
                      Name="Cavity.TaskManagement.EventLog.Messages.lib"
                      Source="obj\Cavity.TaskManagement.EventLog.Messages.lib" />
                <util:EventSource Log="Cavity"
                                  Name="Task Management"
                                  CategoryCount="2"
                                  CategoryMessageFile="[#Messages]"
                                  EventMessageFile="[#Messages]"
                                  ParameterMessageFile="[#Messages]" />
              </Component>
            </Directory>
          </Directory>
        </Directory>
				<Directory Id="Company" Name="Cavity">
					<Directory Id="INSTALLLOCATION" Name="Task Management">
            <Component Id="Service"
                       Guid="1d8762a5-3916-46a3-80b6-64f967525150">
              <File Id="CavityCore" 
                    Name="Cavity.Core.dll" 
                    Source="obj\Cavity.Core.dll"/>
              <File Id="CavityTaskManagement"
                    Name="Cavity.TaskManagement.dll"
                    Source="obj\Cavity.TaskManagement.dll"/>
              <File Id="CavityTaskManagementService"
                    KeyPath="yes"
                    Name="Cavity.TaskManagement.Service.exe"
                    Source="obj\Cavity.TaskManagement.Service.exe"/>
              <File Id="CavityTaskManagementServiceConfig"
                    Name="Cavity.TaskManagement.Service.exe.config"
                    Source="obj\Cavity.TaskManagement.Service.exe.config"/>
              <File Id="log4net"
                    Name="log4net.dll"
                    Source="obj\log4net.dll"/>
              <File Id="log4netConfig"
                    Name="log4net.config"
                    Source="obj\log4net.config"/>
              <File Id="MicrosoftPracticesServiceLocation"
                    Name="Microsoft.Practices.ServiceLocation.dll"
                    Source="obj\Microsoft.Practices.ServiceLocation.dll"/>
              <ServiceInstall Id="CavityTaskManagementServiceInstall" 
                              Name="CavityTaskManagement"
                              DisplayName="Cavity Task Management"
                              Description="Provides a pluggable task management service."
                              ErrorControl="normal"
                              Start="auto"
                              Type="ownProcess" 
                              Account="[SERVICEACCOUNT]"
                              Password="[SERVICEPASSWORD]"
                              Vital="yes" />
              <ServiceControl Id='CavityTaskManagementServiceControl'
                              Name='CavityTaskManagement'
                              Remove='uninstall'
                              Start='install'
                              Stop='both'
                              Wait='yes' />
            </Component>
					</Directory>
				</Directory>
      </Directory>
    </Directory>

		<Feature Id="ProductFeature" Title="Task Management Service" Level="1">
			<ComponentGroupRef Id="Product.Generated" />
      <ComponentRef Id="EventLog" />
      <ComponentRef Id="Service" />
		</Feature>
	</Product>
</Wix>